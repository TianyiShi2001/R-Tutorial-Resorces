# 更多的基本操作，数据类型，运算，逻辑和函数 {#ch3}

## 运算

### 基础

#### 基础中的基础（加减乘除）

最基础的arithmetic operators（数学运算符）有：

|  符号     |     描述    |
|:---------:|:-----------:|
|   `+`     | 加          |
| `-`       | 减          |
| `*`       | 乘          |
| `/`       | 除以        |
| `^`或`**` | 乘幂        |

以上这些应该不需要解释。

#### 求整数商和余数
`%%`    是求余数符号，比如7%%3得到1；

`%/%`   是求整数商，比如7%%3得到2；

最常见的两个用法是判定一个数的奇偶性，和时间，角度等单位的转换。（后面再详细介绍）。

#### 对数

`log(x, base=y)`便是运算$\log_y{x}$，或者写成
`log(base=y, x)`也可以;

它可以简写成`log(x,y)`，同样表示的是$\log_y{x}$，但是如果写成`log(y,x)`就变成了$\log_x{y}$

如果你有一点编程基础，应该能看明白为什么，如果没看明白，下面讲函数的时候我会解释。




## 逻辑

### TRUE和FALSE

### Logical Operators（逻辑运算符）

R中的logical operators 有：

|符号|描述|
|:--:|:----:|
|`==`  |equal to（等于）|
|`!=`  |equal to（不等于）|
|`<`|less than（小于）|
|`>`|more than（大于）|
|`<=`|less than or equal to（小于等于）|
|`>=`|more than or equal to（大于等于）|
|`&`|AND（和）|
|`|`|OR（或）|
|`!`|反义符号（见下）|

## 以下是不重要的一些内容

### Console和R script编辑器的一些特性

Console 中每个命令开头的`>`叫做prompt（我不知道它的中文名诶），当它出现在你所编辑的那一行的开头时，按下回车的时候那行的命令才会被执行。有时候它会消失，这时候按`esc`可以将其恢复。

prompt消失的主要原因是你的代码没有写完，比如括号不完整：
```{}
> 2+(3+4
```
这时你按回车，它会显示：
```{}
> 2+(3+4
+
```
`+`号是在提示代码没写完整。这时你把括号补上再按回车：
```{}
> 2+(3+4
+ )
```

```{}
[1] 9
```
便可以完成计算。

这意味着我们可以把一条很长的命令分成很多行。比如我们可以写这样的代码（在R script编辑器中！）
```{r eval=FALSE}
if(1 + 1 == 2 & 1 + 2 == 5){
  print(2)
} else{
  print(3)
}
```
然后`Ctrl`+`Enter`执行。

```

```{}
<function>(<argument> = <value>)
```

### 赋值(assignment): 使用`<-`，而不是`=`

与很多其他的计算机语言不同，`<-`是R中的赋值符号：
```{r}
x <- 2
```

## 简易的统计学计算

### t分布

下面介绍的这几种方法是以这个t分布函数图为基础的：

```{r include=FALSE}
library(tidyverse)
```

```{r echo=FALSE}
t.values <- seq(-4.5,4.5,.1)

t.probability <- dt(t.values,df=6)

all <- tibble(val=t.values,prob=t.probability)

cut <- tibble(val=t.values[1:75],prob=t.probability[1:75])

ggplot()+
  geom_line(data=all, aes(x=val,y=prob))+
  geom_area(data=cut,aes(x=val,y=prob))+
  theme_light()+
  labs(x="t",y="probability density")+
  geom_vline(xintercept = 2.9, linetype="dashed", color='grey')+
  geom_text(aes(x=3,y=0.1, label="t*"))+
  scale_y_continuous(expand = c(0,0)) + scale_x_continuous(expand = c(0,0))
```

阴影区域为$P$，虚线对应的$t$为$t^*$. `qt()`可以把$P$转化成$t^*$,`pt()`则相反。

举个例子就明白了。假设你需要算一个confidence interval（置信区间），confidence level（置信等级）为$95\%$，即$\alpha=0.05$，degrees of freedom(自由度)为$12$，那么怎么算$t^*$呢？

```{r}
qt(0.975, df = 12)
```

对，就是这么简单。（为什么是$0.975$？因为你要把$0.05$分到左右两边，就等同于t分布的$t=0.095$）

再举一个例子，你在做t检验，双尾的，算出来$t=1.345$，自由度是$15$，那么$p$值怎么算呢？

```{r}
p <- (1-(pt(2.2, df = 15)))*2
p
```

其中`pt(2.2, df = 15)`算出阴影面积，1减去它再乘以二就是对应的双尾t检验的$p$值。

### z分布

没有z分布专门的函数。可以直接用t分布代替，把`df`调到很大（比如`999999`）就行了。比如我们试一下$95\%$置信区间所对应的$z$：
```{r}
qt(0.975,9999999)
```
（果然是$1.96$）

### t检验

t test分为以下几种：

- One sample t test
- Two sample...
  - paired t test
  - Unequal variance t test
  - Equal variance t test
  
在R中做t检验，很简单，以上这些t检验，都是用`t.test` 这个函数去完成。

以one sample为例：

```{r}
x <- c(2.23,2.24,2.34,2.31,2.35,2.27,2.29,2.26,2.25,2.21,2.29,2.34,2.32)
t.test(x, mu = 2.31)
```

可以看到$p=0.06766$。

R的默认是双尾检验，你也可以设置成单尾的：

```{r}
x <- c(2.23,2.24,2.34,2.31,2.35,2.27,2.29,2.26,2.25,2.21,2.29,2.34,2.32)

t.test(x, mu = 2.31, alternative = "less")
```

$p$值一下就减了一半。

Two-sample:

```{r}
x <- c(2.23,2.24,2.34,2.31,2.35,2.27,2.29,2.26,2.25,2.21,2.29,2.34,2.32)
y <- c(2.27,2.29,2.37,2.38,2.39,2.25,2.39,2.16,2.55,2.81,2.19,2.44,2.22)

t.test(x, y)
```

r的默认是non-paired, unequal variance，你可以通过增加`paired = TRUE`，`var.equal = TRUE`这两个参数来改变它。

```{r}
t.test(x, y, paired = TRUE)
```

### $\chi^2$ 检验

$\chi^2$有两种，good
